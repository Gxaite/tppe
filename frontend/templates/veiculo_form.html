{% extends "base.html" %}

{% block title %}{{ 'Editar' if veiculo else 'Novo' }} Veículo - AutoPro{% endblock %}
{% block breadcrumb %}{{ 'Editar' if veiculo else 'Novo' }} Veículo{% endblock %}

{% block content %}
<div class="page-header">
    <div class="page-title-section">
        <h1>
            <i class="bi bi-{{ 'pencil' if veiculo else 'plus-circle' }} text-primary"></i>
            {{ 'Editar Veículo' if veiculo else 'Novo Veículo' }}
        </h1>
        <p>{{ 'Atualize as informações do veículo' if veiculo else 'Preencha os dados do veículo para cadastrar' }}</p>
    </div>
    <div class="page-actions">
        <a href="{{ url_for('views.veiculos_list') }}" class="btn btn-secondary">
            <i class="bi bi-arrow-left"></i> Voltar
        </a>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h2 class="card-title">
            <i class="bi bi-car-front-fill"></i>
            Dados do Veículo
        </h2>
    </div>
    <div class="card-body">
        <form method="POST"
            action="{{ url_for('views.veiculo_edit', id=veiculo.id) if veiculo else url_for('views.veiculo_create') }}">
            <div class="form-row">
                <div class="form-group">
                    <label class="form-label" for="placa">Placa *</label>
                    <input type="text" id="placa" name="placa" class="form-control"
                        value="{{ veiculo.placa if veiculo else '' }}" placeholder="ABC-1234" required maxlength="8"
                        style="text-transform: uppercase;">
                    <span class="form-hint">Formato: ABC-1234 ou ABC1D23</span>
                </div>

                <div class="form-group">
                    <label class="form-label" for="marca">Marca *</label>
                    <input type="text" id="marca" name="marca" class="form-control"
                        value="{{ veiculo.marca if veiculo else '' }}" placeholder="Ex: Toyota, Honda, Fiat" required>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label class="form-label" for="modelo">Modelo *</label>
                    <input type="text" id="modelo" name="modelo" class="form-control"
                        value="{{ veiculo.modelo if veiculo else '' }}" placeholder="Ex: Corolla, Civic, Uno" required>
                </div>

                <div class="form-group">
                    <label class="form-label" for="ano">Ano *</label>
                    <input type="number" id="ano" name="ano" class="form-control"
                        value="{{ veiculo.ano if veiculo else '' }}" placeholder="Ex: 2023" required min="1900"
                        max="2030">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label class="form-label" for="cor">Cor</label>
                    <select id="cor" name="cor" class="form-control form-select">
                        <option value="">Selecione uma cor</option>
                        {% set cores = ['Preto', 'Branco', 'Prata', 'Cinza', 'Vermelho', 'Azul', 'Verde', 'Amarelo',
                        'Laranja', 'Marrom', 'Bege', 'Rosa', 'Roxo'] %}
                        {% for cor_option in cores %}
                        <option value="{{ cor_option }}" {{ 'selected' if veiculo and veiculo.cor==cor_option else ''
                            }}>
                            {{ cor_option }}
                        </option>
                        {% endfor %}
                    </select>
                </div>

                {% if session.get('tipo_usuario') == 'gerente' %}
                <div class="form-group">
                    <label class="form-label" for="proprietario_id">Proprietário</label>
                    <select id="proprietario_id" name="proprietario_id" class="form-control form-select">
                        <option value="">Selecione o proprietário</option>
                        {% if clientes %}
                        {% for cliente in clientes %}
                        <option value="{{ cliente.id }}" {{ 'selected' if veiculo and
                            veiculo.proprietario_id==cliente.id else '' }}>
                            {{ cliente.nome }} ({{ cliente.email }})
                        </option>
                        {% endfor %}
                        {% endif %}
                    </select>
                </div>
                {% endif %}
            </div>

            <div class="form-group">
                <label class="form-label" for="observacoes">Observações</label>
                <textarea id="observacoes" name="observacoes" class="form-control" rows="3"
                    placeholder="Informações adicionais sobre o veículo...">{{ veiculo.observacoes if veiculo and veiculo.observacoes else '' }}</textarea>
            </div>

            <div class="action-buttons mt-3">
                <button type="submit" class="btn btn-primary btn-lg">
                    <i class="bi bi-check-lg"></i>
                    {{ 'Atualizar' if veiculo else 'Cadastrar' }} Veículo
                </button>
                <a href="{{ url_for('views.veiculos_list') }}" class="btn btn-secondary btn-lg">
                    <i class="bi bi-x-lg"></i> Cancelar
                </a>
            </div>
        </form>
    </div>
</div>
{% endblock %}